\section{Conclusion and Outlook}
\label{sec:conclusion}

In the present thesis, a fully coupled solution algorithm for the Navier-Stokes equations with a finite-volume method was implemented. The method used co-located, locally refined, block-structured grids and was able to handle hanging nodes resulting from non-matching block boundaries. The main difference of this algorithm, compared to the commonly used segregated solution algorithms, was the implicit pressure-velocity coupling. The pressure-velocity coupling is a characterizing aspect of solution algorithms for Navier-Stokes equations with the potential to significantly reduce the time for computation. Furthermore, the solution algorithm was extended to solve for buoyancy driven flows, by using an implicit Boussinesq approximation in the momentum balances to achieve velocity-to-temperature coupling and a semi-implicit Newton-Raphson linearization to realize implicit temperature-to-velocity/pressure coupling.

An existing solver framework, the CAFFA framework, which was extended during this thesis, was verified using a grid convergence study and a three-dimensional manufactured solution for the velocities, the pressure and the temperature. Further studies on the segregated solution algorithm showed, that a special modification of the widely used Rhie-Chow momentum interpolation scheme is necessary to calculate results that are independent of the under-relaxation factor and thus comparable with the results obtained with a fully coupled solution algorithm. The implementation of the algorithm considered the use of high performance computers by using the PETSc library for parallelisation of the involved data structures and solving the resulting linear systems with solvers and preconditioners provided by the same toolkit.

A comparison study was performed, dealing with the effect of implicit pressure-velocity coupling in the numerical solution process of the Navier-Stokes equations. Parallel performance measurements showed, that, for the implementation of the segregated and the coupled solution algorithm, scalable program behaviour is possible for high numbers of involved unknowns. Performance studies on flows through complex geometries demonstrated, that the fully couple solution algorithm outperforms the segregated solution algorithm. Other studies performed in the present work showed, that the over-relaxed approach, accounting for non-orthogonality of the numerical grid behaves superior to other commonly used non-orthogonal correctors, the orthogonal corrector and the minimum corrector, when applied on heavily skewed numerical grids.

Finally, a simple load balancing technique, relying on automatic matrix partitioning was presented, revealing the potential of achieving ideal load balancing for the involved linear solvers.

The analyses regarding the different degrees of velocity-to-temperature and temperature-to-velocity/pressure coupling showed, that the implicit temperature-to-velocity/pressure coupling is the key aspect of maintaining high efficiency regarding the computation time for flow problems involving temperature transport and strong coupling between the velocities, the pressure and the temperature.

The present thesis revealed different starting points to further examine the effects of coupled solution algorithms in the context of finite-volume flow solvers. In the present thesis only stationary problems were solved. Due to the moderate Rayleigh number for the heated cavity test case a stationary solution existed. By increasing the Rayleigh number the coupling between the velocities, the pressure and the temperature gets stronger and the flow will get instationary. A further investigation could examine if coupled solution methods maintain the higher efficiency compared to segregated solution algorithms when applied to instationary flows.

In this thesis a temperature equation was successfully coupled to the modeling equations of a fluid. One straightforward application of the solver would deal with conjugate heat transfer problems. In practice there exist other similar transport equations that exhibit strong coupling to the velocities. Examples are the scalar transport of volume fractions, when multiphase flow problems are solved with Volume-of-Fluid methods, or turbulent flows, which, depending on the turbulence model, involve further scalar quantities that are strongly coupled to the velocities. Subsequent studies could examine, if for the corresponding transport equations an implicit coupling method could be efficiently implemented.

All linear systems surging from the discretization process of the coupled system of partial differential equations were solved using black-box implementations of the available solvers in the PETSc library. As studies on finite-volume \cite{klaij13,darwish09,mangani14} and finite-element \cite{brown12,elman03,elman08,silvester01,turek02,mcinnes14} discretizations show, a lot of information has not been used in the solution process of the linear system yet, which imposes a barrier on performance. In order to exploit the coupling and the structure of the linear systems two different approaches can be considered. On approach features so called \emph{physics-based} preconditioners as the SIMPLE preconditioner or other Schur-type preconditioners introduced in \cite{klaij13,elman08}. This kind of preconditioners accelerates the solution of the linear systems by taking into account the matrix structure, as presented in figure \ref{fig:nointerlacemat}. At the moment further active research is needed to develop preconditioners for fully coupled systems surging from finite-volume discretizations. Another approach that additionally maintains high scalability of the solution algorithm of the resulting linear systems, has been presented in \cite{darwish09,mangani14}. In these references, algebraic multigrid methods are constructed, which, different to the GAMG preconditioner of PETSc, take into account the matrix structure.

As the studies in the present thesis demonstrated, segregated solution algorithms perform well compared to fully coupled solution algorithms for smaller numbers of unknowns. Furthermore due to the lower requirements on system memory, the problems that can be solved with segregated solution algorithms may for very high numbers of unknowns, not be computable with fully coupled solution algorithms. Especially for flows involving temperature transport many other implementations of segregated solution algorithms exist \cite{liu84,oliveira01}, whose performance has not been compared with a coupled solution method.

