\section{Introduction}

Due to the advancements in computer architecture and algorithms, the involvement of numerical methods in sciences and industrial practice has increased significantly during the past decades, having a great impact on academic research and processes in industrial development. Besides theoretical or experimental approaches, numerical methods nowadays form an integral part in fostering a better understanding of physical phenomena and in modeling the behaviour of technical systems. Numerical methods are used for the simulation of fluid flow problems, a branch of numerics also known as \emph{CFD} (\emph{Computational Fluid Dynamics}). CFD continuously reaches the limits of current simulation environments, creating new challenges to further improvements of the deployed hardware and software. CFD methods not only have to respond to a higher level of complexity, which can include complex geometries or multiphysical phenomena, they are also expected to generate results after shorter periods of simulation. To overcome these challenges, research is done into the implementation of novel and more efficient algorithms; apart from that, CFD applications often rely on the efficient usage of high performance computer clusters. 

In the field of CFD, the incompressible Navier-Stokes equations represent the commonly used mathematical model for incompressible fluid flows. Among other properties, this model couples two variables, velocity and pressure. Thus, algorithms that tend to solve for incompressible flow fields have to address the so called pressure-velocity coupling. A common approach is to resolve this coupling through segregated solution methods. By these methods, the algebraic equations for each of the dependent variables are solved sequentially, using approximate values for the other involved variables. One common representative of this type of algorithms is the SIMPLE-algorithm, being widely used in scientific codes or industrial solvers due to its small memory requirements and the efficient iterative solvers which exist for the resulting linear systems. Reference \cite{acharya07} reviews the evolution of this type of algorithms.

The use of segregated solution algorithms entails significant deficiencies. In order to stabilize the iteration for the coupling process, the obtained solutions have to be under-relaxed. In doing so, the degree of under-relaxation also depends on the problem to be solved. Not only does this degrade the solver's performance, but, making things even more difficult, there also don't exist strict rules for the best selection of the appropriate amount of under-relaxation. Furthermore, algorithms like SIMPLE lack scalability with the mesh size. Resolving the pressure-velocity coupling defines the flow solver's performance. Consequently, new coupling algorithms, more robust or even independent of parameters, and, at the same time, resource efficient in their application, have to be developed. A helpful analysis of pressure-velocity coupling can be found in \cite{peric90}.

An alternative approach to the problem is by means of coupled solvers, which simultaneously solve the momentum and mass balance equations. Algorithms of this type, working on co-located grids, have been used in \cite{chen10,darwish09,falk13,galpin86,klaij13,mangani14,vakilipour12}. It has been shown that the principal advantages of coupled solution approaches compensate for the deficiencies of segregated solution algorithms. On the one hand, the computational time is reduced, while, on the other hand, the robustness of the solution algorithm increases. According to \cite{darwish09} no under-relaxation is necessary at all to obtain a robust implementation.  

So far, only \cite{galpin86,vakilipour12} have used coupled solution processes for flow problems implicitly involving temperature transport. The mentioned references extended the scope of a coupled solution process for the two-dimensional Navier-Stokes equations to include a temperature equation. They investigated the effect of different methods for implicit temperature-to-velocity/pressure coupling on the solver's performance, showing that the number of iterations until convergence is significantly reduced by the use of coupled methods. The objectives of the present thesis are to implement a fully-coupled solution algorithm for the three-dimensional Navier-Stokes equations and the temperature equation on co-located grids, and to analyse their single and multi-processor performance.

In REF, the thesis introduces the mathematical and physical fundamentals of flow problems. Section REF presents the main frame of partial differential equations that have to be solved numerically. Each subsection outlines a derivation from the continuum mechanical point of view, and shows common simplifications, comprising not only the Navier-Stokes equations for incompressible fluids but also the Boussinesq approximation, which is widely used for incompressible flows experiencing buoyant forces.

Section number \ref{sec:fvm} outlines the fundamentals of finite-volume methods in general. At first, the necessary terminology for numerical grids is introduced. After that, the main approximation principles for the discretization of integral or differential operators are presented, placing particular emphasis on the modifications necessary for discretizing them on non-orthogonal grids. At the end, the chapter outlines the main method of linearization for the Navier-Stokes equations used throughout the work.

Section \ref{sec:seg} focuses on segregated solution methods, because many ideas of the commonly used SIMPLE-algorithm are also relevant for the implementation of coupled solution methods. The section starts by discretizing the mass balance coming directly from the continuum mechanical introduction of the first section, outlining its drawbacks on their applicability to co-located variable arrangements. Subsection \ref{sec:massflux} introduces a remedy to the \emph{checker-boarding} effect surging from an unmodified discretization of the mass balance, by introducing a modification of the commonly used Rhie-Chow \cite{rhie82} momentum interpolation scheme. This modification yields results which do not depend on under-relaxation. This is important for later comparison studies with the coupled solution algorithm. In subsection \ref{sec:simple}, the popular SIMPLE-algorithm is derived, using the previously demonstrated interpolation scheme as a basis for the construction of a pressure correction equation. In subsections \ref{sec:segpresscorr}, \ref{sec:segdiscretization} and \ref{sec:discretetemperature}, the pressure equation and the two remaining sets of equations, i.e. the three momentum balances and the temperature equation, are discretized. Each section concludes with a complete list of the resulting discretized equations and calculations of the coefficients as they have been implemented in the developed solver framework. Subsection \ref{sec:boundary} is dedicated to the implementation of boundary conditions, presenting the necessary modifications to the discretized equations for each boundary condition. This includes the treatment of block boundaries. Since in most cases the boundary conditions lead to a singular system for the pressure correction, subsection \ref{sec:singularitytreatment} describes methods to constrain the pressure in incompressible flows. This section concludes by presenting the non-zero structure of the resulting assembled linear system, taking into account the special treatment of block boundaries with hanging nodes.

The structure of section \ref{sec:cpld}, describing the implemented coupled solution algorithm, resembles section \ref{sec:seg}, since both solution approaches share a great part of their components. This is why special emphasis is put on the differences between both algorithms. Subsection \ref{sec:reconsider} therefore reconsiders the pressure velocity coupling that accounts for the implicit consideration of the pressure in the momentum balances. A major difference to segregated solution methods is then presented in \ref{sec:temperaturecoupling}: the coupling to the temperature equation. Here, different methods, varying in their relation of implicit to explicit coupling of velocities, pressure, and temperature, are deduced. After that, the necessary modifications for boundary conditions are presented. Subsection \ref{sec:cpldassembly} shows the final form of the discretized equations and the resulting structure of the assembled linear systems, placing special emphasis on the effects of the different methods leading to implicit coupling of the velocities to the temperature equation and vice versa.

Section \ref{sec:caffa} introduces the developed \emph{CAFFA} (\emph{Computer Aided Fluid Flow Analysis}) framework, having its theoretical basis in the preceding chapters. The framework is linked to the PETSc library, being a sophisticated framework for the parallelisation of solver applications surging in scientific computing, and providing a set of efficient preconditioners and Krylov subspace solvers for the solution of linear systems. Subsection REF then introduce the other building blocks of the framework, beginning with a grid generator for arbitrarily refined block-structured grids and a preprocessor program, concluding with implementation details of the CAFFA solver. These details comprise the used message passing model, the control of convergence and the data decomposition in the context of parallel computation.

Section \ref{sec:verification} presents the results of a conducted convergence study to verify the CAFFA framework. After a brief introduction to the theory behind the verification of scientific codes via manufactured solutions, a manufactured solution for the Navier-Stokes equations using the Boussinesq approximation is proposed by the author, followed by the results of a grid convergence study to prove the order of accuracy of the developed solvers within the CAFFA framework. The section concludes with the results of a short study on the effect the under-relaxation factors of the velocities have on the final result of calculations.

Section \ref{sec:compare} presents the results of the performance analyses conducted on the high performance cluster \emph{HHLR} (\emph{Hessischer Hochleistungsrechner}) of TU Darmstadt. After introducing the used hardware and deployed software configuration and the relevant performance metrics, program runtime is measured and application speedup is calculated. Furthermore, a study on the weak scalability of the developed fully coupled solution algorithm is conducted. The section concludes with performance analyses regarding the efficiency of coupled and segregated solution algorithms for flow problems, considering, among other test cases, complex geometries and buoyancy forces.

The last section \ref{sec:conclusion} summarizes the results of the conducted research work, giving an outlook on further research.

